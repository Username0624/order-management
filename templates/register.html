<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>註冊帳號</title>
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

<div class="register-container">
    <h2 class="main-title">註冊</h2>
    
    <p class="sub-title">已經是會員？ <a href="#" id="toLogin" class="link-text">返回登入</a></p>
    
    <div class="form-grid">
        
        <div class="grid-column form-column">
            <form id="registerForm" class="register-form">
                
                <div class="input-group">
                    <label for="username">使用者名稱</label>
                    <input type="text" id="username" placeholder="請輸入使用者名稱" required>
                </div>

                <div class="input-group">
                    <label for="email">電子郵件地址</label>
                    <input type="email" id="email" placeholder="user@example.com" required>
                    <p class="input-error" id="email-error"></p> 
                </div>

                <div class="input-group">
                    <label for="password">密碼</label>
                    <input type="password" id="password" placeholder="請輸入密碼" required>
                    <a href="#" class="forgot-link">密碼長度至少為8個字元</a>
                </div>
                
                <button type="submit" class="submit-btn primary-blue">註冊</button>
            </form>
        </div>

        <div class="grid-column social-column">
            
            <button class="social-btn google-red">
                <svg viewBox="0 0 48 48" class="google-icon"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.91 3.51 30.73 2 24 2 15.68 2 8.35 6.2 4 12.55l7.98 6.19C14.62 14.65 19.46 9.5 24 9.5z"></path><path fill="#4285F4" d="M46.7 24c0-1.87-.16-3.66-.47-5.38H24v10.15h11.96c-.53 2.53-2.07 4.73-4.3 6.24l7.98 6.19C42.86 42.14 46.7 33.72 46.7 24z"></path><path fill="#FBBC05" d="M12.55 35.45c-1.28-.79-2.28-1.89-2.9-3.14l-7.98 6.19C8.35 41.8 15.68 46 24 46c6.73 0 11.91-2.03 16.2-5.59l-6.85-6.85c-2.5 2.38-5.67 3.6-9.21 3.6z"></path><path fill="#34A853" d="M4.01 12.55C3.38 15.1 3 17.65 3 20.45 3 22.95 3.38 25.5 4.01 28.05l7.98-6.19c-.31-1.42-.48-2.9-.48-4.41s.17-2.99.48-4.41L4.01 12.55z"></path></svg>
                使用 Google 帳戶註冊
            </button>
        </div>
    </div>
    
    <p id="msg" class="message-area"></p>
</div>

<script src="/static/api.js"></script>
<script>
    // 註冊事件
    document.getElementById("registerForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        const msgElement = document.getElementById("msg");
        msgElement.className = 'message-area'; // 重置類別

        const result = await apiRegister(
            username.value,
            email.value,
            password.value
        );

        msgElement.innerText = result.message || result.error;
        
        if (result.success) {
            msgElement.classList.add('success');
            // 註冊成功，1秒後跳回登入頁
            setTimeout(() => location.href = "login", 1000);
        } else {
            msgElement.classList.add('error');
        }
    });

    // 返回登入按鈕事件
    document.getElementById("toLogin").addEventListener("click", (e) => {
        e.preventDefault(); // 阻止 a 標籤預設行為
        location.href = "login";
    });
    
    console.log("register page loaded");
</script>

</body>
</html>